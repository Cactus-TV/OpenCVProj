# OpenCVProj
## Детекция шара без использования ИИ

1. **Предобработка изображения**:
   - Преобразование изображения в градации серого, чтобы уменьшить количество данных и упростить последующие вычисления.
   - Применение размытия для сглаживания изображения и уменьшения шума, который может мешать детекции.

2. **Детекция кругов**:
   - Использование алгоритма HoughCircles, который основан на преобразовании Хафа для нахождения кругов на изображении.
   - Подстройка параметров детекции (`param1`, `param2`, `minRadius`, `maxRadius`), чтобы точно находить круги, соответствующие шарам. Кроме того я обрабатываю лишь ту часть фрейма, где есть шар.

## Детекция шара с использованием ИИ
Для поиска шара маятника использовалась YOLO (You Only Look Once) модель (yolov8n), которая обучалась на изображениях, содержащих шары. Модель обучалась на автоматически сгенерированном и размеченном наборе данных с кругами оттенков серого, которых могло быть несколько, они пересекались и тп.

Процесс обучения включал следующие этапы:

1. **Сбор данных**: Изображения с кругами.
2. **Разметка данных**: Ограничивающие рамки для каждого шара на изображениях.
3. **Обучение модели**: Использование фреймворка YOLO для обучения модели на размеченных данных. Я использовал файн-тьюнинг предобученной модели, заморозив 21 модель и оставив лишь 22 модель для обучения.
4. **Проблемы**: Первая модель училась на цветных кругах по одному на изображении, но так как на кадрах с камеры кругов как минимум 3 всегда видны, то я решил изменить набор данных. Кроме того, подкрутив контрастность в градациях серого у изображения и вырезав нужный участок с фрейма я ещё ограничил нужные мне круги. После применил фильтр на размер бокса у кругов и уверенность модели - и смог найти нужный мне шар из 30+ обнаруженных кругов. Обучал при помощи кода в training_yolo.ipynb

Модель показала хорошую точность в обнаружении шаров, способна работать в реальном времени с частотой 10 Гц и выше.

__client.py__ - код клиента с обработкой изображений используя один из двух способов (выбирается в коде вручную) и передача на сервер
__server.py__ - тестовый сервер
__best.pt__ - обученная модель YoloV8 nano